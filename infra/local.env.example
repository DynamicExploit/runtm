# Runtm Local Development Environment
# Copy this file to .env in the project root

# ============================================================================
# CLI Configuration (add these to your ~/.zshrc or ~/.bashrc for local dev)
# ============================================================================
# export RUNTM_API_URL=http://localhost:8000
# export RUNTM_TOKEN=dev-token-change-in-production

# API Authentication
RUNTM_API_TOKEN=dev-token-change-in-production

# Database
DATABASE_URL=postgresql://runtm:runtm@postgres:5432/runtm

# Redis
REDIS_URL=redis://redis:6379

# Fly.io Configuration (required for deployments)
# IMPORTANT: Use a Personal Access Token from `fly auth token` (NOT a deploy token)
# Personal access tokens work for both Machines API and Logs API
FLY_API_TOKEN=your-fly-personal-access-token-here
FLY_ORG=personal

# Storage
ARTIFACT_STORAGE_PATH=/artifacts

# Auth mode (single_tenant or multi_tenant)
AUTH_MODE=single_tenant

# Build Optimization
# Remote builder (recommended): Builds AND deploys on Fly's infra in one step
# - Faster: No local Docker build or image push over network
# - Simpler: Single flyctl deploy command handles everything
# - Auto-generates fly.toml with optimized health checks
# Set to false to build locally with Docker, then push to Fly registry
USE_REMOTE_BUILDER=true

# ============================================================================
# Custom Domain Configuration (Hosted Version)
# ============================================================================
# When set, deployments get URLs like <app>.runtm.com instead of <app>.fly.dev
#
# How it works:
#   1. User deploys via Runtm -> app created on Fly as runtm-abc123.fly.dev
#   2. Runtm creates DNS CNAME: runtm-abc123.runtm.com -> runtm-abc123.fly.dev
#   3. Runtm adds SSL certificate for runtm-abc123.runtm.com
#   4. User sees URL: https://runtm-abc123.runtm.com
#
# Requirements:
#   - Domain (runtm.com) DNS managed by Cloudflare
#   - Cloudflare API token with Zone.DNS edit permission
#   - Cloudflare Zone ID for the domain
#
# Leave empty for local dev (uses fly.dev URLs directly)
# RUNTM_BASE_DOMAIN=runtm.com

# DNS Provider
# Enables automatic DNS record creation for custom domain URLs
# Currently supported: "cloudflare"
# DNS_PROVIDER=cloudflare

# Cloudflare Configuration
# Required when DNS_PROVIDER=cloudflare
#
# To get these values:
#   1. Log in to Cloudflare Dashboard (dash.cloudflare.com)
#   2. Select your domain (e.g., runtm.com)
#   3. Zone ID: In the right sidebar under "API"
#   4. API Token: My Profile > API Tokens > Create Token
#      - Use "Edit zone DNS" template
#      - Select specific zone (runtm.com)
#      - Copy the token (only shown once!)
#
# CLOUDFLARE_API_TOKEN=your-cloudflare-api-token-here
# CLOUDFLARE_ZONE_ID=your-zone-id-here

